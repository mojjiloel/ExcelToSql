# æ‹¼éŸ³åº“é›†æˆæ–¹æ¡ˆ

## å½“å‰å®ç°ï¼šæ™ºèƒ½è¯æ±‡æ˜ å°„ + æ‹¼éŸ³å­—å…¸ âœ…

### ä¼˜åŠ¿
1. **æ— éœ€é¢å¤–ä¾èµ–** - ä¸éœ€è¦å®‰è£…ç¬¬ä¸‰æ–¹åº“
2. **æ™ºèƒ½æ˜ å°„** - 100+ å¸¸ç”¨ä¸šåŠ¡è¯æ±‡ç›´æ¥æ˜ å°„ä¸ºæ ‡å‡†è‹±æ–‡
3. **å›½é™…åŒ–å‘½å** - ç¬¦åˆæ•°æ®åº“æœ€ä½³å®è·µ
4. **è½»é‡é«˜æ•ˆ** - å¯åŠ¨å¿«ï¼Œå†…å­˜å ç”¨å°

### æ˜ å°„ç¤ºä¾‹

| ä¸­æ–‡åˆ—å | è½¬æ¢ç»“æœ | è¯´æ˜ |
|----------|----------|------|
| å§“å | Name | å¸¸ç”¨è¯æ±‡æ˜ å°„ |
| å¹´é¾„ | Age | å¸¸ç”¨è¯æ±‡æ˜ å°„ |
| ç”µè¯å·ç  | PhoneNumber | å¸¸ç”¨è¯æ±‡æ˜ å°„ |
| åˆ›å»ºæ—¶é—´ | CreateTime | å¸¸ç”¨è¯æ±‡æ˜ å°„ |
| éƒ¨é—¨ | Department | å¸¸ç”¨è¯æ±‡æ˜ å°„ |
| å·¥èµ„ | Salary | å¸¸ç”¨è¯æ±‡æ˜ å°„ |
| å…¥èŒæ—¥æœŸ | HireDate | å¸¸ç”¨è¯æ±‡æ˜ å°„ |
| å‘˜å·¥ç¼–å· | EmployeeID | ç»„åˆæ˜ å°„ï¼ˆå‘˜å·¥+ç¼–å·ï¼‰ |

---

## å¯é€‰æ–¹æ¡ˆä¸€ï¼šNPinyin åº“ï¼ˆå¼€æºå…è´¹ï¼‰â­â­â­â­â­

### ç®€ä»‹
- **ä»“åº“**: https://github.com/stulzq/NPinyin
- **åè®®**: MITï¼ˆå®Œå…¨å…è´¹å•†ç”¨ï¼‰
- **æ”¯æŒ**: .NET Framework 2.0+
- **å¤§å°**: ~100KB
- **æ±‰å­—æ•°**: 20,000+

### å®‰è£…æ­¥éª¤

#### 1. é€šè¿‡ NuGet åŒ…ç®¡ç†å™¨å®‰è£…
åœ¨ Visual Studio ä¸­ï¼š
```
å·¥å…· -> NuGet åŒ…ç®¡ç†å™¨ -> ç®¡ç†è§£å†³æ–¹æ¡ˆçš„ NuGet ç¨‹åºåŒ…
æœç´¢ "NPinyin" -> å®‰è£…
```

æˆ–è€…åœ¨åŒ…ç®¡ç†å™¨æ§åˆ¶å°æ‰§è¡Œï¼š
```powershell
Install-Package NPinyin
```

#### 2. æ‰‹åŠ¨ä¸‹è½½å®‰è£…
1. ä¸‹è½½ DLLï¼šhttps://www.nuget.org/packages/NPinyin
2. è§£å‹ nupkg æ–‡ä»¶ï¼ˆæ”¹åä¸º .zipï¼‰
3. å¤åˆ¶ `lib/net20/NPinyin.dll` åˆ°é¡¹ç›®
4. åœ¨é¡¹ç›®ä¸­æ·»åŠ å¼•ç”¨

### ä½¿ç”¨æ–¹æ³•

æ›¿æ¢ `PinyinHelper.cs` ä¸­çš„è½¬æ¢æ–¹æ³•ï¼š

```csharp
using NPinyin;

public static string ConvertToPinyin(string chinese)
{
    if (string.IsNullOrEmpty(chinese))
        return "Col";

    string trimmed = chinese.Trim();
    
    // ä¼˜å…ˆä½¿ç”¨å¸¸ç”¨è¯æ±‡æ˜ å°„
    if (commonNameDict.ContainsKey(trimmed))
    {
        return commonNameDict[trimmed];
    }

    // ä½¿ç”¨ NPinyin è½¬æ¢
    // GetInitials: è·å–é¦–å­—æ¯ï¼ˆå¦‚ï¼šä¸­å›½ -> ZGï¼‰
    // GetPinyin: è·å–å®Œæ•´æ‹¼éŸ³ï¼ˆå¦‚ï¼šä¸­å›½ -> ZhongGuoï¼‰
    string pinyin = Pinyin.GetPinyin(trimmed);
    
    // ç§»é™¤ç©ºæ ¼å’ŒéŸ³è°ƒ
    pinyin = pinyin.Replace(" ", "");
    
    // é¦–å­—æ¯å¤§å†™
    if (pinyin.Length > 0)
        pinyin = char.ToUpper(pinyin[0]) + pinyin.Substring(1).ToLower();
    
    return string.IsNullOrEmpty(pinyin) ? "Col" : pinyin;
}
```

### NPinyin å¸¸ç”¨æ–¹æ³•

```csharp
// 1. è·å–å…¨æ‹¼ï¼ˆå¸¦ç©ºæ ¼ï¼‰
Pinyin.GetPinyin("ä¸­å›½");  // "Zhong Guo"

// 2. è·å–å…¨æ‹¼ï¼ˆæ— ç©ºæ ¼ï¼‰
Pinyin.GetPinyin("ä¸­å›½").Replace(" ", "");  // "ZhongGuo"

// 3. è·å–é¦–å­—æ¯
Pinyin.GetInitials("ä¸­å›½");  // "ZG"

// 4. å¤šéŸ³å­—å¤„ç†
Pinyin.GetPinyin("é“¶è¡Œ");  // "Yin Hang"ï¼ˆè‡ªåŠ¨é€‰æ‹©å¸¸ç”¨è¯»éŸ³ï¼‰
```

---

## å¯é€‰æ–¹æ¡ˆäºŒï¼šTinyPinyin.NET â­â­â­â­

### ç®€ä»‹
- **ä»“åº“**: https://github.com/hueifeng/TinyPinyin.NET
- **åè®®**: Apache 2.0
- **ç‰¹ç‚¹**: æè‡´æ€§èƒ½ï¼Œä½“ç§¯æ›´å°

### å®‰è£…
```powershell
Install-Package TinyPinyin
```

### ä½¿ç”¨ç¤ºä¾‹
```csharp
using TinyPinyin;

string pinyin = PinyinHelper.GetPinyin("ä¸­æ–‡", "");  // "ZhongWen"
string initials = PinyinHelper.GetShortPinyin("ä¸­æ–‡");  // "ZW"
```

---

## å¯é€‰æ–¹æ¡ˆä¸‰ï¼šPinYinConverterCore â­â­â­â­

### ç®€ä»‹
- **åè®®**: MIT
- **ç‰¹ç‚¹**: æ”¯æŒ .NET Core å’Œ .NET Framework

### å®‰è£…
```powershell
Install-Package PinYinConverterCore
```

---

## æ€§èƒ½å¯¹æ¯”

| æ–¹æ¡ˆ | å†…å­˜å ç”¨ | è½¬æ¢é€Ÿåº¦ | DLLå¤§å° | å‡†ç¡®åº¦ |
|------|----------|----------|---------|--------|
| å½“å‰å®ç°ï¼ˆè¯æ±‡æ˜ å°„+å­—å…¸ï¼‰ | æå° (~20KB) | æå¿« | 0 | é«˜ï¼ˆå¸¸ç”¨è¯ï¼‰ |
| NPinyin | å° (~100KB) | å¿« | 87KB | éå¸¸é«˜ |
| TinyPinyin.NET | å° (~80KB) | æå¿« | 76KB | é«˜ |
| PinYinConverterCore | ä¸­ (~300KB) | ä¸­ | 256KB | éå¸¸é«˜ |

---

## æ¨èé€‰æ‹©

### åœºæ™¯ä¸€ï¼šé€šç”¨ä¸šåŠ¡ç³»ç»Ÿï¼ˆæ¨èå½“å‰æ–¹æ¡ˆï¼‰
- âœ… åˆ—åå¤šä¸ºæ ‡å‡†ä¸šåŠ¡å­—æ®µï¼ˆå§“åã€å¹´é¾„ã€éƒ¨é—¨ç­‰ï¼‰
- âœ… è¿½æ±‚é›¶ä¾èµ–
- âœ… è¦æ±‚å›½é™…åŒ–å‘½å
- **å»ºè®®**: ä½¿ç”¨å½“å‰çš„è¯æ±‡æ˜ å°„æ–¹æ¡ˆ

### åœºæ™¯äºŒï¼šå¤æ‚ä¸šåŠ¡ç³»ç»Ÿï¼ˆæ¨è NPinyinï¼‰
- âœ… åˆ—ååŒ…å«å¤§é‡è‡ªå®šä¹‰å­—æ®µ
- âœ… éœ€è¦å¤„ç†å„ç§ç”Ÿåƒ»å­—
- âœ… å¯ä»¥æ¥å—é¢å¤–ä¾èµ–
- **å»ºè®®**: é›†æˆ NPinyin åº“

### åœºæ™¯ä¸‰ï¼šé«˜æ€§èƒ½è¦æ±‚ï¼ˆæ¨è TinyPinyin.NETï¼‰
- âœ… éœ€è¦å¤„ç†å¤§é‡æ•°æ®
- âœ… å¯¹æ€§èƒ½è¦æ±‚æé«˜
- **å»ºè®®**: ä½¿ç”¨ TinyPinyin.NET

---

## æ‰©å±•å½“å‰å®ç°

å¦‚æœä¸æƒ³ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥æ‰©å±•è¯æ±‡æ˜ å°„å­—å…¸ï¼š

### 1. æ·»åŠ è¡Œä¸šä¸“ç”¨è¯æ±‡
```csharp
// åœ¨ InitializeCommonNameDict() ä¸­æ·»åŠ 
commonNameDict["æ‚£è€…"] = "Patient";      // åŒ»ç–—è¡Œä¸š
commonNameDict["å­¦å·"] = "StudentNo";    // æ•™è‚²è¡Œä¸š
commonNameDict["è®¢å•å·"] = "OrderNo";    // ç”µå•†è¡Œä¸š
```

### 2. æ”¯æŒç»„åˆè¯æ±‡
```csharp
// æ™ºèƒ½æ‹†åˆ†ç»„åˆï¼ˆå·²å®ç°ï¼‰
"å‘˜å·¥å§“å" -> "EmployeeName"  // å‘˜å·¥ + å§“å
"éƒ¨é—¨ç¼–å·" -> "DepartmentID"  // éƒ¨é—¨ + ç¼–å·
```

### 3. æ·»åŠ æ›´å¤šæ‹¼éŸ³å­—ç¬¦
```csharp
// åœ¨ InitializePinyinDict() ä¸­æ‰©å±•
pinyinDict['æ‚£'] = "Huan";
pinyinDict['è€…'] = "Zhe";
```

---

## å®Œæ•´é›†æˆç¤ºä¾‹ï¼ˆNPinyinï¼‰

å¦‚æœæ‚¨å†³å®šä½¿ç”¨ NPinyinï¼Œè¿™æ˜¯å®Œæ•´çš„ä¿®æ”¹æ­¥éª¤ï¼š

### Step 1: æ·»åŠ  NPinyin å¼•ç”¨
ä¿®æ”¹ `packages.config`:
```xml
<package id="NPinyin" version="0.3.0" targetFramework="net40" />
```

### Step 2: ä¿®æ”¹ PinyinHelper.cs
```csharp
using NPinyin;

public static string ConvertToPinyin(string chinese)
{
    if (string.IsNullOrEmpty(chinese))
        return "Col";

    string trimmed = chinese.Trim();
    
    // ä¼˜å…ˆåŒ¹é…å¸¸ç”¨è¯æ±‡
    if (commonNameDict.ContainsKey(trimmed))
        return commonNameDict[trimmed];

    // ä½¿ç”¨ NPinyin è½¬æ¢
    try
    {
        string pinyin = Pinyin.GetPinyin(trimmed).Replace(" ", "");
        if (!string.IsNullOrEmpty(pinyin))
        {
            // é¦–å­—æ¯å¤§å†™ï¼ˆé©¼å³°å‘½åï¼‰
            pinyin = char.ToUpper(pinyin[0]) + pinyin.Substring(1).ToLower();
            return pinyin;
        }
    }
    catch
    {
        // è½¬æ¢å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ
    }
    
    // é™çº§åˆ°åŸæœ‰å­—å…¸æ–¹æ¡ˆ
    return ConvertByPinyin(trimmed);
}
```

### Step 3: é‡æ–°ç¼–è¯‘
```bash
msbuild ExcelToSql.csproj /p:Configuration=Release /t:Rebuild
```

---

## æ€»ç»“

### å½“å‰æ–¹æ¡ˆå·²ç»å¾ˆä¼˜ç§€ âœ…
- 100+ å¸¸ç”¨ä¸šåŠ¡è¯æ±‡æ˜ å°„
- ç¬¦åˆå›½é™…åŒ–æœ€ä½³å®è·µ
- é›¶ä¾èµ–ï¼Œè½»é‡å¿«é€Ÿ
- é€‚åˆ 80% çš„ä½¿ç”¨åœºæ™¯

### ä½•æ—¶éœ€è¦å‡çº§
- éœ€è¦å¤„ç†å¤§é‡éæ ‡å‡†å­—æ®µå
- åŒ…å«ç”Ÿåƒ»å­—æˆ–ä¸“ä¸šæœ¯è¯­
- è¦æ±‚ 100% æ±‰å­—è¦†ç›–

### æˆ‘çš„å»ºè®®
**å…ˆä½¿ç”¨å½“å‰æ–¹æ¡ˆ**ï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­å‘ç°ä¸è¶³æ—¶ï¼Œå†è€ƒè™‘é›†æˆ NPinyinã€‚è¿™æ ·å¯ä»¥ä¿æŒé¡¹ç›®ç®€æ´ï¼Œé¿å…ä¸å¿…è¦çš„ä¾èµ–ã€‚

å¦‚æœæ‚¨å†³å®šé›†æˆ NPinyinï¼Œæˆ‘å¯ä»¥ç«‹å³ä¸ºæ‚¨ä¿®æ”¹ä»£ç ï¼ğŸ˜Š
