# 快速开始

## 程序已成功编译！

可执行文件位置：
```
c:\Users\CYQ\Demos\PrettyText\ExcelToSql\ExcelToSql\bin\Debug\ExcelToSql.exe
```

## 功能清单 ✅

### 核心功能
- ✅ 读取 Excel 文件（.xls 和 .xlsx）
- ✅ 使用 NPOI 库解析 Excel
- ✅ 预览 Excel 数据
- ✅ 选择不同的 Sheet
- ✅ 指定列头行位置
- ✅ 中文列名自动转拼音
- ✅ 数据库兼容性列名处理

### 支持的数据库
- ✅ SQL Server（T-SQL 语法）
- ✅ MySQL（MySQL 语法）
- ✅ Oracle（PL/SQL 语法）

### 生成的 SQL 内容
- ✅ DROP TABLE 语句（如果表存在）
- ✅ CREATE TABLE 语句（根据列头创建）
- ✅ INSERT 语句（批量插入数据）

### 辅助功能
- ✅ 复制 SQL 到剪贴板
- ✅ 保存 SQL 到文件
- ✅ 自定义表名
- ✅ 数据类型自动识别

## 使用示例

### 1. 准备测试数据
创建一个 Excel 文件，包含如下数据：

| 姓名 | 年龄 | 部门   | 工资  | 入职日期   |
|------|------|--------|-------|------------|
| 张三 | 25   | 技术部 | 8000  | 2023-01-15 |
| 李四 | 30   | 销售部 | 10000 | 2022-05-20 |
| 王五 | 28   | 财务部 | 9000  | 2023-03-10 |

### 2. 打开工具
运行 ExcelToSql.exe

### 3. 操作步骤
1. **选择文件**：点击"浏览..."选择 Excel 文件
2. **选择 Sheet**：在下拉框中选择要转换的工作表
3. **设置列头行**：默认第1行，可以根据实际调整
4. **预览数据**：查看数据是否正确（列头行会高亮显示）
5. **选择数据库**：选择目标数据库类型
6. **输入表名**：输入要创建的表名（如：员工信息）
7. **生成 SQL**：点击"生成SQL"按钮
8. **使用 SQL**：复制或保存生成的 SQL 脚本

### 4. SQL Server 示例输出

```sql
IF OBJECT_ID('YuanGongXinXi', 'U') IS NOT NULL DROP TABLE [YuanGongXinXi];

CREATE TABLE [YuanGongXinXi] (
    [XingMing] NVARCHAR(MAX),
    [NianLing] INT,
    [BuMen] NVARCHAR(MAX),
    [GongZi] INT,
    [RuZhiRiQi] DATETIME
);

INSERT INTO [YuanGongXinXi] ([XingMing], [NianLing], [BuMen], [GongZi], [RuZhiRiQi]) VALUES (N'张三', 25, N'技术部', 8000, '2023-01-15 00:00:00');
INSERT INTO [YuanGongXinXi] ([XingMing], [NianLing], [BuMen], [GongZi], [RuZhiRiQi]) VALUES (N'李四', 30, N'销售部', 10000, '2022-05-20 00:00:00');
INSERT INTO [YuanGongXinXi] ([XingMing], [NianLing], [BuMen], [GongZi], [RuZhiRiQi]) VALUES (N'王五', 28, N'财务部', 9000, '2023-03-10 00:00:00');
```

### 5. MySQL 示例输出

```sql
DROP TABLE IF EXISTS `YuanGongXinXi`;

CREATE TABLE `YuanGongXinXi` (
    `XingMing` TEXT,
    `NianLing` INT,
    `BuMen` TEXT,
    `GongZi` INT,
    `RuZhiRiQi` DATETIME
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO `YuanGongXinXi` (`XingMing`, `NianLing`, `BuMen`, `GongZi`, `RuZhiRiQi`) VALUES ('张三', 25, '技术部', 8000, '2023-01-15 00:00:00');
INSERT INTO `YuanGongXinXi` (`XingMing`, `NianLing`, `BuMen`, `GongZi`, `RuZhiRiQi`) VALUES ('李四', 30, '销售部', 10000, '2022-05-20 00:00:00');
INSERT INTO `YuanGongXinXi` (`XingMing`, `NianLing`, `BuMen`, `GongZi`, `RuZhiRiQi`) VALUES ('王五', 28, '财务部', 9000, '2023-03-10 00:00:00');
```

### 6. Oracle 示例输出

```sql
BEGIN
   EXECUTE IMMEDIATE 'DROP TABLE YuanGongXinXi';
EXCEPTION
   WHEN OTHERS THEN NULL;
END;

CREATE TABLE YuanGongXinXi (
    XingMing NVARCHAR2(2000),
    NianLing NUMBER(10),
    BuMen NVARCHAR2(2000),
    GongZi NUMBER(10),
    RuZhiRiQi DATE
);

INSERT INTO YuanGongXinXi (XingMing, NianLing, BuMen, GongZi, RuZhiRiQi) VALUES ('张三', 25, '技术部', 8000, TO_DATE('2023-01-15 00:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO YuanGongXinXi (XingMing, NianLing, BuMen, GongZi, RuZhiRiQi) VALUES ('李四', 30, '销售部', 10000, TO_DATE('2022-05-20 00:00:00', 'YYYY-MM-DD HH24:MI:SS'));
INSERT INTO YuanGongXinXi (XingMing, NianLing, BuMen, GongZi, RuZhiRiQi) VALUES ('王五', 28, '财务部', 9000, TO_DATE('2023-03-10 00:00:00', 'YYYY-MM-DD HH24:MI:SS'));
```

## 列名转换规则

### 中文转拼音示例：
- 姓名 → XingMing
- 年龄 → NianLing
- 部门 → BuMen
- 工资 → GongZi
- 入职日期 → RuZhiRiQi
- 电话号码 → DianHuaHaoMa
- 邮箱地址 → YouXiangDiZhi

### 处理规则：
1. 中文字符转为对应拼音（首字母大写）
2. 英文和数字保持不变
3. 特殊字符替换为下划线
4. 确保以字母开头
5. 重复列名自动添加数字后缀

## 数据类型映射

| Excel 类型 | SQL Server | MySQL | Oracle |
|------------|------------|-------|--------|
| 整数       | INT        | INT   | NUMBER(10) |
| 小数       | DECIMAL(18,2) | DECIMAL(18,2) | NUMBER(18,2) |
| 日期时间   | DATETIME   | DATETIME | DATE |
| 布尔值     | BIT        | TINYINT(1) | NUMBER(1) |
| 文本       | NVARCHAR(MAX) | TEXT | NVARCHAR2(2000) |

## 技术特性

- **框架版本**：.NET Framework 4.0
- **Excel 库**：NPOI 2.5.1
- **打包方式**：Costura.Fody（所有依赖已嵌入 exe）
- **界面技术**：Windows Forms
- **支持格式**：.xls (Excel 97-2003) 和 .xlsx (Excel 2007+)

## 项目结构

```
ExcelToSql/
├── ExcelReader.cs         # Excel 读取核心类
├── SqlGenerator.cs        # SQL 生成器（含3种数据库实现）
├── PinyinHelper.cs        # 中文转拼音工具
├── Form1.cs               # 主窗体逻辑
├── Form1.Designer.cs      # 主窗体设计器
└── Program.cs             # 程序入口
```

## 优势特点

1. **无需安装**：所有依赖已打包，双击即用
2. **智能转换**：自动识别数据类型和列名
3. **多库支持**：一次转换，适配多种数据库
4. **实时预览**：可视化预览 Excel 数据
5. **便捷操作**：一键复制或保存 SQL

## 适用场景

- 快速导入临时数据到数据库
- Excel 数据迁移到数据库
- 数据分析前的数据准备
- 测试数据快速生成
- 数据库表结构快速建立

---

**享受使用吧！** 🎉
